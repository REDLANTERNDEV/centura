version: '3.9'

# ============================================
# GitHub Actions CI/CD Configuration Example
# For automated Docker builds and deployments
# ============================================

# This is a reference configuration for CI/CD
# Copy to .github/workflows/docker-deploy.yml to use

services:
  # Build only - no run
  backend:
    build:
      context: . # Root context for workspace
      dockerfile: apps/backend/Dockerfile
      target: production
      cache_from:
        - type=registry,ref=myregistry/mini-saas-backend:cache
      cache_to:
        - type=registry,ref=myregistry/mini-saas-backend:cache
    image: myregistry/mini-saas-backend:latest

  frontend:
    build:
      context: . # Root context for workspace
      dockerfile: apps/frontend/Dockerfile
      target: production
      cache_from:
        - type=registry,ref=myregistry/mini-saas-frontend:cache
      cache_to:
        - type=registry,ref=myregistry/mini-saas-frontend:cache
    image: myregistry/mini-saas-frontend:latest
